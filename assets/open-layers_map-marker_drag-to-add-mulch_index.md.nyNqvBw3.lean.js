var s=Object.defineProperty,i=(i,a,n)=>(((i,a,n)=>{a in i?s(i,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[a]=n})(i,"symbol"!=typeof a?a+"":a,n),n);import{z as a,A as n,S as h,aa as k,ac as l,i as p,J as t,T as e,X as E,V as r,k as d,a as g,m as y,o as F,c as o,f as c,q as C,u as A,M as D,ad as u,t as B,G as m,I as v,Q as f,_ as q,p as _,g as x,h as b}from"./app.2DJL4jsJ.js";import{A as w,M as P}from"../js/index/index.sBZz26mU.js";const S=({coordinate:s,vectorSource:i,imageUrl:l,name:p="标注点"})=>{if(null===i)return;const t=new a({geometry:new n(s),name:p});t.setStyle((s=>new h({image:new k({crossOrigin:"anonymous",src:s,scale:.1})}))(l)),i.addFeature(t)};class I extends l{constructor(){super(),i(this,"coordinate_"),i(this,"cursor_"),i(this,"feature_"),i(this,"previousCursor_"),this.coordinate_=null,this.cursor_="pointer",this.feature_=null,this.previousCursor_=void 0}handleDownEvent(s){const i=s.map.forEachFeatureAtPixel(s.pixel,(function(s){return s}));return i&&(this.coordinate_=s.coordinate,this.feature_=i),!!i}handleDragEvent(s){if(null===this.coordinate_||null===this.feature_)return;const i=s.coordinate[0]-this.coordinate_[0],a=s.coordinate[1]-this.coordinate_[1];this.feature_.getGeometry().translate(i,a),this.coordinate_[0]=s.coordinate[0],this.coordinate_[1]=s.coordinate[1]}handleMoveEvent(s){if(this.cursor_){const i=s.map.forEachFeatureAtPixel(s.pixel,(function(s){return s})),a=s.map.getTargetElement();i?a.style.cursor!=this.cursor_&&(this.previousCursor_=a.style.cursor,a.style.cursor=this.cursor_):void 0!==this.previousCursor_&&(a.style.cursor=this.previousCursor_,this.previousCursor_=void 0)}}handleUpEvent(){return this.coordinate_=null,this.feature_=null,!1}}const M={class:"top"},T=["src"],L=q(p({__name:"index",setup(s){let i,a=null;const n=t(null),h=t(null),k=["/image/chips.png","/image/ice_cream.png"],l=new e({source:new E({attributions:w,url:P,maxZoom:20})}),p=new r,q=new d({source:p}),_=s=>{const i=s.target.src;s.dataTransfer.setData("src",i)},x=s=>{s.preventDefault()},b=s=>{var i;if(null===a)return;const n=null==(i=s.dataTransfer)?void 0:i.getData("src"),{layerX:h,layerY:k}=s,l=a.getCoordinateFromPixel([h,k]);S({coordinate:l,vectorSource:p,imageUrl:n}),s.stopPropagation()},L=()=>{const s=q.getSource();null!==s&&null!==h.value&&(s.removeFeature(h.value),h.value=null,i.setPosition(void 0))};return g((()=>{const s=document.getElementById("map");var k;s&&(s.oncontextmenu=()=>!1),a=new D({target:"map",interactions:u().extend([new I]),layers:[l,q],view:new B({projection:"EPSG:4326",center:[0,0],zoom:5}),controls:m().extend([new v])}),i=new f({element:n.value||void 0,positioning:"center-center"}),a.addOverlay(i),a&&((k=a).getViewport().oncontextmenu=function(s){s.preventDefault();const a=k.getEventPixel(s),n=k.forEachFeatureAtPixel(a,(s=>s));if(n){const a=k.getEventCoordinate(s);h.value=n,i.setPosition(a)}},a.on("singleclick",(()=>{i.setPosition(void 0)})))})),y((()=>{a&&(a.dispose(),a=null)})),(s,i)=>(F(),o(C,null,[c("div",M,[(F(),o(C,null,A(k,((s,i)=>c("img",{key:i,src:s,draggable:"true",onDragstart:_},null,40,T))),64))]),c("div",{id:"map",onDrop:b,onDragover:x},[c("div",{class:"menu",ref_key:"menu",ref:n},[c("div",{class:"menu-item",onClick:L},"删除")],512)],32)],64))}}),[["__scopeId","data-v-fc75d5ea"]]),U=c("h1",{id:"拖拽添加覆盖物",tabindex:"-1"},[x("拖拽添加覆盖物 "),c("a",{class:"header-anchor",href:"#拖拽添加覆盖物","aria-label":'Permalink to "拖拽添加覆盖物"'},"​")],-1),V=c("div",{class:"tip custom-block"},[c("p",{class:"custom-block-title"},"TIP"),c("p",null,"拖拽下方的图标到地图指定位置可以生成覆盖物。"),c("p",null,"对着地图上的覆盖物单击右键可以移除。")],-1),O=b("",6),j=JSON.parse('{"title":"拖拽添加覆盖物","description":"","frontmatter":{},"headers":[],"relativePath":"open-layers/map-marker/drag-to-add-mulch/index.md","filePath":"open-layers/map-marker/drag-to-add-mulch/index.md","lastUpdated":1704792985000}'),G={name:"open-layers/map-marker/drag-to-add-mulch/index.md"},X=Object.assign(G,{setup:s=>(s,i)=>(F(),o("div",null,[U,V,_(L),O]))});export{j as __pageData,X as default};
