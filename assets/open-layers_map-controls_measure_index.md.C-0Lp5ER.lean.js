import{Q as s,R as i,U as a,D as n,S as h,F as k,l,C as p,k as t,i as e,T as E,X as r,V as d,j as g,a as y,m as F,n as o,o as c,c as A,f as C,g as D,p as u,w as B,M as m,t as q,P as f,L as T,W as w,q as v,u as b,d as M,_ as S,h as P}from"./app.2DJL4jsJ.js";import{A as L,M as x}from"../js/index/index.sBZz26mU.js";function V({measureTooltipElement:i,map:a}){i&&i.parentNode&&i.parentNode.removeChild(i);const n=document.createElement("div");n.className="tooltip tooltip-measure";const h=new s({element:n,offset:[0,-15],positioning:"bottom-center"});return a.addOverlay(h),[n,h]}const G={id:"map"},j={id:"menu"},H=S(e({__name:"index",setup(e){const S=new E({source:new r({attributions:L,url:x,maxZoom:20})}),P=new d,H=g({checked:!1,typeSelect:"length",options:[{label:"长度",value:"length"},{label:"面积",value:"area"}],map:null,sketch:null,helpTooltipElement:null,helpTooltip:null,measureTooltipElement:null,measureTooltip:null,draw:null}),O=()=>{if(null===H.map)return;const s=function(s){return new t({source:s,style:new h({fill:new k({color:"rgba(255, 255, 255, 0.2)"}),stroke:new l({color:"#ffcc33",width:2}),image:new p({radius:7,fill:new k({color:"#ffcc33"})})})})}(P);H.map.addLayer(s)},N=s=>{if(s.dragging)return;let i="单击开始绘图";if(H.sketch){const s=H.sketch.getGeometry();s instanceof f?i="单击继续绘制多边形":s instanceof T&&(i="单击继续绘制直线")}null!==H.helpTooltipElement&&null!==H.helpTooltip&&(H.helpTooltipElement.innerHTML=i,H.helpTooltip.setPosition(s.coordinate),H.helpTooltipElement.classList.remove("hidden"))},_=()=>{if(null===H.map)return;const t="area"===H.typeSelect?"Polygon":"LineString";let e;H.draw=function({source:s,type:i}){return new n({source:s,type:i,style:new h({fill:new k({color:"rgba(255, 255, 255, 0.2)"}),stroke:new l({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new p({radius:5,stroke:new l({color:"rgba(0, 0, 0, 0.7)"}),fill:new k({color:"rgba(255, 255, 255, 0.2)"})})})})}({source:P,type:t}),H.map.addInteraction(H.draw),[H.measureTooltipElement,H.measureTooltip]=V({measureTooltipElement:H.measureTooltipElement,map:H.map}),[H.helpTooltipElement,H.helpTooltip]=function({helpTooltipElement:i,map:a}){i&&i.parentNode&&i.parentNode.removeChild(i);const n=document.createElement("div");n.className="tooltip hidden";const h=new s({element:n,offset:[15,0],positioning:"center-left"});return a.addOverlay(h),[n,h]}({helpTooltipElement:H.helpTooltipElement,map:H.map}),H.draw.on("drawstart",(function(s){let n;H.sketch=s.feature;const h=H.sketch.getGeometry();h&&(e=h.on("change",(function(s){if(null===H.map)return;const h=s.target;let k="";h instanceof f?(k=function({checked:s,polygon:i,map:n}){let h,k;if(s){const s=n.getView().getProjection(),k=i.clone().transform(s,"EPSG:4326");h=Math.abs(a(k,{projection:s,radius:6378137}))}else h=i.getArea();return k=h>1e4?Math.round(h/1e6*100)/100+" km<sup>2</sup>":Math.round(100*h)/100+" m<sup>2</sup>",k}({checked:H.checked,polygon:h,map:H.map}),n=h.getInteriorPoint().getCoordinates()):h instanceof T&&(k=function({checked:s,line:a,map:n}){let h,k;if(s){const s=n.getView().getProjection();h=i(a,{projection:s,radius:6378137})}else h=Math.round(100*a.getLength())/100;return k=h>100?Math.round(h/1e3*100)/100+" km":Math.round(100*h)/100+" m",k}({checked:H.checked,line:h,map:H.map}),n=h.getLastCoordinate()),H.measureTooltipElement&&(H.measureTooltipElement.innerHTML=k),H.measureTooltip&&H.measureTooltip.setPosition(n)})))})),H.draw.on("drawend",(function(){null!==H.measureTooltipElement&&null!==H.measureTooltip&&null!==H.map&&(H.measureTooltipElement.className="tooltip tooltip-static",H.measureTooltip.setOffset([0,-7]),H.sketch=null,H.measureTooltipElement=null,[H.measureTooltipElement,H.measureTooltip]=V({measureTooltipElement:H.measureTooltipElement,map:H.map}),w(e))}))},I=()=>{null!==H.map&&null!==H.draw&&(H.map.removeInteraction(H.draw),_())};return y((()=>{H.map=new m({target:"map",layers:[S],view:new q({projection:"EPSG:4326",center:[0,0],zoom:5})}),O(),H.map&&(H.map.on("pointermove",N),H.map.getViewport().addEventListener("mouseout",(()=>{H.helpTooltipElement&&H.helpTooltipElement.classList.add("hidden")}))),_()})),F((()=>{H.map&&(H.map.dispose(),H.map=null)})),(s,i)=>{const a=o("el-option"),n=o("el-select"),h=o("el-checkbox");return c(),A("div",G,[C("div",j,[D(" 几何体类型 "),u(n,{modelValue:H.typeSelect,"onUpdate:modelValue":i[0]||(i[0]=s=>H.typeSelect=s),placeholder:"Select",size:"small",onChange:I,class:"select"},{default:B((()=>[(c(!0),A(v,null,b(H.options,(s=>(c(),M(a,{key:s.value,label:s.label,value:s.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),u(h,{modelValue:H.checked,"onUpdate:modelValue":i[1]||(i[1]=s=>H.checked=s),label:"使用测地线的措施",size:"large"},null,8,["modelValue"])])])}}}),[["__scopeId","data-v-9becc27d"]]),O=C("h1",{id:"测量",tabindex:"-1"},[D("测量 "),C("a",{class:"header-anchor",href:"#测量","aria-label":'Permalink to "测量"'},"​")],-1),N=C("div",{class:"tip custom-block"},[C("p",{class:"custom-block-title"},"TIP"),C("p",null,"单击开始绘图。左下角可以选择几何体的类型和是否使用测地线的措施。")],-1),_=P("",4),I=JSON.parse('{"title":"测量","description":"","frontmatter":{},"headers":[],"relativePath":"open-layers/map-controls/measure/index.md","filePath":"open-layers/map-controls/measure/index.md","lastUpdated":1704792985000}'),U={name:"open-layers/map-controls/measure/index.md"},z=Object.assign(U,{setup:s=>(s,i)=>(c(),A("div",null,[O,N,u(H),_]))});export{I as __pageData,z as default};
